<h1 id="waitingMessage">Watch Full Screen Youtube Here</h1>

<script type="text/javascript">

	var wPlaylist = [];

	var YTIFrameManager = {

		"wPlayer" : null,
		"playlist" : null,
		"usingPlaylist": false,
		"muted": false,
		"nowPlaying": { id: null , time: 0 },
		"lastPlayed": { id: null , time: 0 },

		tearDown: function() {
			YTIFrameManager.wPlayer.destroy();
			setTimeout(function(){
				YTIFrameManager.wPlayer = null,
				$(document).trigger( "yt-player-destoyed" );
				$("#waitingMessage").show();
			} , 1000 );
		},

		showVideo: function(wVideo) {

			$("#waitingMessage").hide();

			if ( !wVideo ){ var wVideo = { id: "o2Qmc8Sb6Ws" }; } 

			var wThis = $(window);
			var wOptions = { version: 3 , height: wThis.height() , width: wThis.width() , videoId: wVideo.id };
			if ( YTIFrameManager.usingPlaylist ) {
				wOptions.videoId = YTIFrameManager.playlist[0];
				wOptions.loop = 1;
			}
			wOptions.events = {
				'onReady': YTIFrameManager.onPlayerReady,
			    'onStateChange': YTIFrameManager.onPlayerStateChange,
			    'onError': YTIFrameManager.errorHandler,
			};

			YTIFrameManager.wPlayer = new YT.Player( 'player', wOptions );

		},

		errorHandler: function(event) {
			console.log( "error = " + event.data.toString() );
		},

		onPlayerStateChange: function(event) {

			var nowPlayingURL = YTIFrameManager.wPlayer.getVideoUrl();
			var wT = nowPlayingURL.split("t=");
			var wID = null;
			if ( wT.length > 1 ) { wT = wT[1]; wT = wT.split("&v="); wID = wT[1]; wT = wT[0]; }
			else { wT = 0; wID = nowPlayingURL.split("v=")[1]; }
			
			if ( YTIFrameManager.nowPlaying.id != wID ) {

				YTIFrameManager.lastPlayed.id = YTIFrameManager.nowPlaying.id;	
				YTIFrameManager.lastPlayed.time = YTIFrameManager.nowPlaying.time;

				YTIFrameManager.nowPlaying.id = wID;
				YTIFrameManager.nowPlaying.time = wT;

			}

			switch ( event.data ) {
				case -1:
					console.log(" video is unstarted ");
					break;
				case 0:
					console.log(" video is over ");
					if ( !YTIFrameManager.usingPlaylist ) {
						YTIFrameManager.tearDown();
					}
					console.log( YTIFrameManager.lastPlayed );
					console.log( YTIFrameManager.nowPlaying );
					break;
				case 1:
					console.log(" video is now playing ");
					$(document).trigger( "ytStandardPlaying" );
					break;
				case 2:
					console.log(" video is paused ");
					break;
				case 3:
					console.log(" video is buffering ");
					break;
				case 5:
					console.log(" new video is cued ");
					break;
			}
		},

		onPlayerReady: function(event) {
			console.log("player is supposedly ready");
			//console.log(YTIFrameManager.wPlayer);
			if ( YTIFrameManager.usingPlaylist ) { 
				YTIFrameManager.wPlayer.cuePlaylist( wPlaylist );
				YTIFrameManager.wPlayer.setShuffle( true );
				setTimeout( function() {
					YTIFrameManager.wPlayer.setLoop(true);
					if ( YTIFrameManager.muted ) { YTIFrameManager.wPlayer.mute(); }
					$(document).trigger( "toggle-f-keypress" );
				} , 2000 );
			}
			else {
				$(document).trigger( "toggle-f-keypress" );	
			}

		},

		getCurrentPlaylistInfo: function() {
			YTIFrameManager.playlist.items = YTIFrameManager.wPlayer.getPlaylist();
			YTIFrameManager.playlist.index = YTIFrameManager.wPlayer.getPlaylistIndex();
			console.log( "Current Playlist Index = " + YTIFrameManager.playlist.index.toString() );
			if ( YTIFrameManager.playlist.items ) {
				for( var i = 0; i < YTIFrameManager.playlist.items.length; ++i ) {
					console.log( YTIFrameManager.playlist.items[i] );
				}
			}
		},

	};


	console.log("gathering stored ID's into playlist array");
	if ( standardList.ytStandard != null ) {
		console.log(standardList.ytStandard);
		for ( var iprop in standardList.ytStandard ) {
			for ( var jprop in standardList.ytStandard[iprop] ) {
				wPlaylist.push( jprop );
			}
		}
	}

	if ( wPlaylist.length > 1 ) { YTIFrameManager.usingPlaylist = true; }

	YTIFrameManager.muted = false;
	YTIFrameManager.playlist = wPlaylist;
	YTIFrameManager.usingPlaylist = true;
	YTIFrameManager.showVideo();

	$(document).on( "tearDownPlayer" , function( event , einfo ) { YTIFrameManager.tearDown(); });
	$(document).on( "nextMedia" , function( event , einfo ) { YTIFrameManager.wPlayer.nextVideo(); });

</script>

<div id="player"></div>